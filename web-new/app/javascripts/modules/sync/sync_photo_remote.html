<!DOCTYPE html>
<html style="height:auto">
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <title>Sync Notification</title>
        <script type="text/javascript" src="../../libraries/require-2.1.2.js"></script>
        <link rel="stylesheet" href="../../../stylesheets/main.css" type="text/css" />
        <script type="text/javascript" language="JavaScript">
            require.config({
                baseUrl : '../../'
            });

            require(['EnvironmentConfig'], function () {
                require(['jquery', 'utilities/QueryString', 'utilities/FormatString', 'IO', 'Configuration', 'Log'], function ($, QueryString, FormatString, IO, CONFIG, log) {
                    var auth = QueryString.get('auth');
                    var source = QueryString.get('source');
                    var synced_photo_num = QueryString.get('synced_photo_num');
                    $('.header_text').html(FormatString('您有 {1} 张照片同步到了电脑', synced_photo_num));

                    log({
                        'event' : 'debug.sync.helper.photo.notify.show'
                    });

                    // open link in browser: wandoujia.com/photos
                    $('.button-open-url').on('click', function (evt) {
                        var target_url = 'https://account.wandoujia.com/?auth=' + window.encodeURIComponent(auth) + '&callback=' + window.encodeURIComponent('http://www.wandoujia.com/photos?source=' + source);

                        IO.requestAsync({
                            url : CONFIG.actions.OPEN_URL_HELPER,
                            data : {
                                url : target_url
                            }
                        });

                        log({
                            'event' : 'ui.click.sync.open.url'
                        });
                    });

                    // open local folder
                    $('.button-open').on('click', function (evt) {
                        IO.requestAsync({
                            url : CONFIG.actions.OPEN_PHOTO_AUTO_BACKUP_FILE_HELPER
                        });

                        log({
                            'event' : 'ui.click.sync.open.folder'
                        });
                    });

                    // open help link in browser
                    $('.button-help').on('click', function (evt) {
                        var target_url = 'www.wandoujia.com/photos/photosync_help?source=notification';

                        IO.requestAsync({
                            url : CONFIG.actions.OPEN_URL_HELPER,
                            data : {
                                url : target_url
                            }
                        });

                        log({
                            'event' : 'ui.click.sync.open.help'
                        });
                    });
                });
            });

        </script>

        <style>
            p {
                margin-top: 10px;
            }
            .wrap {
                padding: 20px;
            }

            .button-open {
                float: right;
                margin-right: 10px;
                margin-top: 10px;
            }

            .button-help {
                float: right;
                margin-top: 10px;
            }

            .header_text {
                margin-bottom: 10px;
            }
        </style>

        <body class="w-notification-body">
            <div class="wrap cf">
                <h2 class="header_text text-primary">照片已经从手机同步到电脑</h2>
                <p>
                    您在手机上的豌豆荚开启了「拍照立即同步」功能。在 Wi-Fi 网络下，豌豆荚会帮您把刚刚拍摄的照片上传到 <span class="link button-open-url">wandoujia.com/photos</span> 保存，并且随时同步到您的电脑上。
                </p>
                <p>
                    如果您不需要照片同步功能，请在手机上的豌豆荚上设置关闭此功能。
                </p>
                <h2><span class="link button-help">了解更多</span></h2>
                <h2><span class="link button-open">查看照片</span></h2>
            </div>
        </body>
</html>
