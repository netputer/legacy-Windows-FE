(function(e,t){define(["underscore","Environment"],function(n,r){console.log("Settings - File loaded.");var i=e.localStorage,s={},o="wdj_user_config_"+r.get("deviceId"),u="wdj_user_config_global",a=JSON.parse(i.getItem(o)||JSON.stringify({})),f=JSON.parse(i.getItem(u)||JSON.stringify({}));return r.get("deviceId")==="Default"&&r.once("change:deviceId",function(e,t){o="wdj_user_config_"+t,a=JSON.parse(i.getItem(o)||JSON.stringify({}))}),s.get=function(e){var r;return arguments.length===0?r=n.extend({},f,a):r=a[e]!==t?a[e]:f[e],r},s.set=function(e,t,n){n===!0||n===r.get("deviceId")?(a[e]=t,i.setItem(o,JSON.stringify(a))):(f[e]=t,i.setItem(u,JSON.stringify(f)))},s.remove=function(e,t){t===!0||t===r.get("deviceId")?(delete a[e],i.setItem(o,JSON.stringify(a))):(delete f[e],i.setItem(u,JSON.stringify(f)))},s.clear=function(e){throw new Error("Settings.clear is not implemented because it's not well defined")},e.Settings=s,s})})(this);