(function(e){define(["jquery","backbone","underscore","doT","Internationalization","Log","ui/TemplateFactory","ui/PopupTip","IO","Device","Configuration","utilities/StringUtil","guide/views/CardView","app/collections/AppsCollection","task/TaskService"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=h.getClass().extend({className:h.getClass().prototype.className+" w-guide-starter",template:r.template(o.get("guide","starter")),loadAppsAsync:function(){var t=e.Deferred();return a.requestAsync({url:l.actions.APP_STARTER,success:function(e){this.apps=e[0].apps.splice(0,8).concat(e[1].apps.splice(0,4)),t.resolve()}.bind(this),error:t.reject}),t.promise()},checkAppsAsync:function(){var t=e.Deferred(),n=p.getInstance(),r=function(e){!e.syncing&&!e.loading&&f.get("isConnected")&&(this.stopListening(e,"refresh",r),e.getNormalApps().length<=20&&t.resolve())};return this.listenTo(n,"refresh",r),n.trigger("update"),t.promise()},checkAsync:function(){var t=e.Deferred();return e.when(this.loadAppsAsync(),this.checkAppsAsync()).done(function(){s({event:"debug.guide_starter_show"}),t.resolve()}).fail(t.reject),t.promise()},render:function(){return this.$el.html(this.template({action:this.options.action,apps:this.apps})),this.$("[data-title]").each(function(){var t=new u({$host:e(this)})}),this},clickButtonInstall:function(n){var r=e(n.currentTarget),i=new t.Model({source:"starter",downloadUrl:decodeURIComponent(r.data("url")),title:r.data("name"),iconPath:r.data("icon")});d.addTask(l.enums.TASK_TYPE_INSTALL,l.enums.MODEL_TYPE_APPLICATION,i),s({event:"ui.click.guide_starter_install"})},clickButtonSkip:function(){v.__super__.clickButtonSkip.call(this),s({event:"ui.click.guide_starter_skip"})},clickButtonAction:function(){var e=n.map(this.apps,function(e){return{downloadUrl:e.apks[0].downloadUrl.url,title:e.title,iconSrc:e.icons.px68,versionName:e.apks[0].versionName,versionCode:e.apks[0].versionCode,size:e.apks[0].bytes,packageName:e.apks[0].packageName}},this);d.batchDownloadAsync(e,"starter-one-key-install"),this.trigger("next"),s({event:"ui.click.guide_starter_install_all"})},events:{"click .button-install":"clickButtonInstall"}}),m=n.extend({getInstance:function(){return new v({action:i.welcome.GUIDE_STARTER_INSTALL_ALL})}});return m})})(this);